library(rpart)
library(rpart.plot)
library(dplyr)
library(caTools)
library(caret)
df<-read.csv("Placement_Data_Full_Class.csv")
df<-select(df,gender,ssc_p,ssc_b,hsc_p,hsc_b,hsc_s,degree_p,degree_t,workex,etest_p,specialisation,mba_p,status)
df$ssc_b<-as.factor(df$ssc_b)
df$hsc_b<-as.factor(df$hsc_b)
df$hsc_s<-as.factor(df$hsc_s)
df$workex<-as.factor(df$workex)
df$gender<-as.factor(df$gender)
df$degree_t<-as.factor(df$degree_t)
df$specialisation<-as.factor(df$specialisation)
df$status<-as.factor(df$status)

set.seed(123)
sample<-sample.split(df$status,SplitRatio=.80)
train<-subset(df,sample==TRUE)
test<-subset(df,sample==FALSE)

tree<-rpart(status~.,data =train)
predict<-predict(tree,test,type="class")
print(confusionMatrix(predict,test$status))
rpart.plot(tree)
prp(tree)
